<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>True Chats - Love & Private</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        body { overflow: hidden; }
        .love-theme-bg { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #feada6 100%); }
        .premium-theme-bg { background-color: #f3f4f6; }
        .glass { background: rgba(255, 255, 255, 0.25); backdrop-filter: blur(4px); border: 1px solid rgba(255, 255, 255, 0.18); }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .animate-pulse-fast { animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes heartBeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.3); }
            28% { transform: scale(1); }
            42% { transform: scale(1.3); }
            70% { transform: scale(1); }
        }
        .heart-beat { animation: heartBeat 1.5s infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- FIREBASE SDK & CONFIG (From your Image) ---
        // Note: In a real HTML file, we use the compat libraries for CDN usage
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, doc, updateDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCAsCm1YcsAjHwyvIzxyMrBmZPLw2hlo18",
            authDomain: "truechats-8dac9.firebaseapp.com",
            projectId: "truechats-8dac9",
            storageBucket: "truechats-8dac9.appspot.com",
            messagingSenderId: "685374771914",
            appId: "1:685374771914:web:81bf491264c1bb09061a33"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- GLOBAL VARIABLES & ICONS ---
        const { useState, useEffect, useRef } = React;
        
        // Dummy Friends Data (Simulating MongoDB Users)
        const MOCK_FRIENDS = [
            { id: '101', name: 'Nani', username: '@nani1248', avatar: null, status: 'online', type: 'general' },
            { id: '102', name: 'My Love', username: '@sweety', avatar: null, status: 'offline', type: 'private' }, 
            { id: '103', name: 'Raju Bhai', username: '@raju', avatar: null, status: 'online', type: 'general' }
        ];

        const FRIEND_REQUESTS = [
            { id: 201, name: 'Varun', mutual: 3 },
            { id: 202, name: 'Priya', mutual: 1 }
        ];

/* --- PART 1 END --- */
        /* --- PART 2 START --- */

        function App() {
            // User & Auth State
            const [user, setUser] = useState(null);
            
            // App Layout State
            const [isLoveTheme, setIsLoveTheme] = useState(false);
            const [currentChat, setCurrentChat] = useState(null);
            const [showRequests, setShowRequests] = useState(false);
            
            // Privacy Features State
            const [isPrivateMode, setIsPrivateMode] = useState(false); // Hidden chats visible?
            const [showPasswordModal, setShowPasswordModal] = useState(false);
            const [passwordInput, setPasswordInput] = useState("");
            const [privatePassword, setPrivatePassword] = useState("1234"); // Default password
            
            // Message Features State
            const [messages, setMessages] = useState([]);
            const [inputText, setInputText] = useState("");
            const [replyTo, setReplyTo] = useState(null); // For Swipe to Reply
            const [editingMsgId, setEditingMsgId] = useState(null); // For Edit
            const [seenAfterDelete, setSeenAfterDelete] = useState(false); // Toggle
            const [disappearTimer, setDisappearTimer] = useState(null); // 24h/48h

            // Video Call State
            const [isVideoCall, setIsVideoCall] = useState(false);
            const [isMicDenied, setIsMicDenied] = useState(false);

            // Auth Listener
            useEffect(() => {
                const unsubscribe = onAuthStateChanged(auth, (u) => setUser(u));
                return () => unsubscribe();
            }, []);

            // Login Handler
            const handleLogin = async () => {
                const provider = new GoogleAuthProvider();
                try { await signInWithPopup(auth, provider); } 
                catch (error) { console.error("Login Error:", error); }
            };

            // Privacy Mode Logic
            const togglePrivateMode = () => {
                if (isPrivateMode) {
                    setIsPrivateMode(false); // Hide everything
                    setCurrentChat(null);
                } else {
                    setShowPasswordModal(true); // Ask password
                }
            };

            const verifyPassword = () => {
                if (passwordInput === privatePassword) {
                    setIsPrivateMode(true);
                    setShowPasswordModal(false);
                    setPasswordInput("");
                } else {
                    alert("Wrong Password! Try again.");
                }
            };

            // Message Sending Logic
            const sendMessage = async () => {
                if (!inputText.trim()) return;

                if (editingMsgId) {
                    // Update Existing Message (Edit Feature)
                    // In real Firebase: await updateDoc(doc(db, "chats", editingMsgId), { text: inputText, edited: true });
                    setMessages(msgs => msgs.map(m => m.id === editingMsgId ? { ...m, text: inputText, isEdited: true } : m));
                    setEditingMsgId(null);
                    setInputText("");
                    return;
                }

                const newMsg = {
                    id: Date.now(),
                    text: inputText,
                    sender: user.uid,
                    timestamp: Date.now(),
                    seen: false,
                    isEdited: false,
                    replyTo: replyTo, // Included Replied Message
                    seenAfterDelete: seenAfterDelete // Feature flag
                };

                // Add to local state (Simulating Firebase real-time listener)
                setMessages(prev => [newMsg, ...prev]);
                setInputText("");
                setReplyTo(null);

                // Simulate Auto Reply
                setTimeout(() => {
                    setMessages(prev => [{
                        id: Date.now() + 1, text: "Received!", sender: 'other', timestamp: Date.now(), seen: false
                    }, ...prev]);
                }, 1500);
            };

            // Delete Message Logic (Delete for Me vs Everyone)
            const deleteMessage = (msgId, timestamp) => {
                const now = Date.now();
                const diffMins = (now - timestamp) / 1000 / 60;
                
                if (diffMins > 24 * 60) {
                    // After 24 Hours -> Delete for Me only
                    setMessages(prev => prev.filter(m => m.id !== msgId));
                } else {
                    // Within 24 Hours -> Confirm
                    if(confirm("Delete for Everyone?")) {
                         setMessages(prev => prev.filter(m => m.id !== msgId));
                    }
                }
            };
            
            // Edit Check (20 Mins Limit)
            const handleEdit = (msg) => {
                const diffMins = (Date.now() - msg.timestamp) / 1000 / 60;
                if (diffMins > 20) {
                    alert("Edit time (20 mins) expired!");
                } else {
                    setInputText(msg.text);
                    setEditingMsgId(msg.id);
                }
            };

/* --- PART 2 END --- */
        /* --- PART 3 START --- */

            // Render Header
            const Header = () => (
                <div className={`h-16 flex items-center justify-between px-4 shadow-md z-20 transition-all ${isLoveTheme ? 'bg-pink-600 text-white' : 'bg-white text-gray-800'}`}>
                    <div className="flex items-center gap-2">
                        <h1 className="text-xl font-bold font-serif tracking-wide">True Chats</h1>
                    </div>

                    <div className="flex items-center gap-3 md:gap-5">
                        {/* Friend Requests */}
                        <div className="relative cursor-pointer" onClick={() => setShowRequests(!showRequests)}>
                            <i className="fas fa-user-friends text-xl"></i>
                            {FRIEND_REQUESTS.length > 0 && <span className="absolute -top-1 -right-2 bg-red-500 text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center border border-white">.</span>}
                        </div>

                        {/* Theme Toggle Heart */}
                        <div className="cursor-pointer hover:scale-110 transition" onClick={() => setIsLoveTheme(!isLoveTheme)}>
                            {isLoveTheme ? 
                                <i className="fas fa-heart text-red-200 text-xl heart-beat"></i> : 
                                <i className="far fa-heart text-xl"></i>
                            }
                        </div>

                        {/* Privacy Eye (Toggle Hidden Chats) */}
                        <div className="cursor-pointer" onClick={togglePrivateMode}>
                            {isPrivateMode ? 
                                <i className="fas fa-eye text-red-500 text-xl"></i> : 
                                <div className="flex items-center"><i className="fas fa-eye-slash text-gray-400 text-xl"></i><div className="w-2 h-2 ml-1 bg-white rounded-full border border-gray-300"></div></div>
                            }
                        </div>

                        {/* Message Disappearing Timer */}
                        <div className="relative group">
                             <i className="fas fa-clock text-xl cursor-pointer"></i>
                             <div className="absolute right-0 top-8 bg-white shadow-lg rounded p-2 hidden group-hover:block w-32 text-gray-800 text-sm">
                                <div className="hover:bg-gray-100 p-1 cursor-pointer" onClick={() => setDisappearTimer(24)}>Min 24 hrs</div>
                                <div className="hover:bg-gray-100 p-1 cursor-pointer" onClick={() => setDisappearTimer(48)}>Max 48 hrs</div>
                             </div>
                        </div>

                        {/* User Profile */}
                        <div className="relative group cursor-pointer">
                            {user?.photoURL ? 
                                <img src={user.photoURL} className="w-8 h-8 rounded-full border-2 border-white" /> : 
                                <div className="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center font-bold">U</div>
                            }
                            {/* Profile Dropdown */}
                            <div className="absolute right-0 top-10 w-48 bg-white shadow-xl rounded-lg p-3 hidden group-hover:block z-50 text-gray-800">
                                <p className="font-bold border-b pb-1">{user?.displayName}</p>
                                <p className="text-xs text-gray-500 mt-1">Friends: 15</p>
                                <button className="w-full text-left text-sm mt-2 hover:bg-gray-100 p-1">Change Username</button>
                                <button className="w-full text-left text-sm hover:bg-gray-100 p-1">Change Password</button>
                                <button onClick={() => auth.signOut()} className="w-full text-left text-sm text-red-500 mt-2 font-bold hover:bg-red-50 p-1">Logout</button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // Friend Request Popup
            const RequestPopup = () => (
                <div className="absolute top-16 right-16 w-64 bg-white shadow-2xl rounded-lg z-50 p-2 border animate-pulse-fast">
                    {FRIEND_REQUESTS.map(req => (
                        <div key={req.id} className="flex justify-between items-center p-2 border-b last:border-0">
                            <div>
                                <p className="font-bold text-sm">{req.name}</p>
                                <p className="text-xs text-gray-500">{req.mutual} Mutual Friends</p>
                            </div>
                            <div className="flex gap-1">
                                <button className="bg-blue-500 text-white px-2 py-1 rounded text-xs">Accept</button>
                                <button className="bg-gray-200 px-2 py-1 rounded text-xs">X</button>
                            </div>
                        </div>
                    ))}
                </div>
            );

            // Sidebar (Chat List)
            const Sidebar = () => (
                <div className={`w-full md:w-1/3 lg:w-1/4 border-r flex flex-col ${isLoveTheme ? 'bg-white/80' : 'bg-white'} ${currentChat ? 'hidden md:flex' : 'flex'}`}>
                    <div className="p-3">
                        <div className="bg-gray-100 rounded-full px-4 py-2 flex items-center">
                            <i className="fas fa-search text-gray-400"></i>
                            <input type="text" placeholder="Search..." className="bg-transparent ml-2 outline-none w-full text-sm"/>
                        </div>
                    </div>
                    
                    <div className="flex-1 overflow-y-auto">
                        {MOCK_FRIENDS.map(f => {
                            // Logic: Show private friends ONLY if private mode is ON
                            if (f.type === 'private' && !isPrivateMode) return null;

                            return (
                                <div key={f.id} onClick={() => setCurrentChat(f)} className="flex items-center p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100">
                                    <div className="relative">
                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg ${isLoveTheme ? 'bg-gradient-to-tr from-pink-400 to-red-500' : 'bg-gray-400'}`}>
                                            {f.name.charAt(0)}
                                        </div>
                                        {f.status === 'online' && <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>}
                                    </div>
                                    <div className="ml-3 flex-1">
                                        <div className="flex justify-between">
                                            <h3 className={`font-bold ${f.type === 'private' ? 'text-pink-600' : 'text-gray-800'}`}>{f.name}</h3>
                                            <span className="text-xs text-gray-400">10:45 AM</span>
                                        </div>
                                        <p className="text-sm text-gray-500 truncate">Click to chat...</p>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );

/* --- PART 3 END --- */
        /* --- PART 4 START --- */

            // Chat Window
            const ChatWindow = () => {
                if (!currentChat) return <div className="hidden md:flex flex-1 items-center justify-center text-gray-400 bg-gray-50">Select a chat to start messaging</div>;

                const [show4Dots, setShow4Dots] = useState(false);

                // Swipe to Reply Simulation (Simple Click for now)
                const handleMessageClick = (msg) => {
                    // In mobile: Swipe logic. Here: Double click to reply
                };

                return (
                    <div className={`flex-1 flex flex-col h-full relative ${isLoveTheme ? 'bg-pink-50' : 'bg-gray-100'}`}>
                        {/* Chat Header */}
                        <div className={`h-16 flex items-center justify-between px-4 shadow-sm ${isLoveTheme ? 'bg-pink-100' : 'bg-white'}`}>
                            <div className="flex items-center cursor-pointer" onClick={() => alert("Receiver Details:\nName: " + currentChat.name + "\nStatus: " + currentChat.status)}>
                                <i className="fas fa-arrow-left md:hidden mr-3" onClick={(e) => { e.stopPropagation(); setCurrentChat(null); }}></i>
                                <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${isLoveTheme ? 'bg-pink-500' : 'bg-gray-500'}`}>
                                    {currentChat.name.charAt(0)}
                                </div>
                                <div className="ml-3">
                                    <h3 className="font-bold text-sm">{currentChat.name}</h3>
                                    <p className="text-xs text-green-500">{currentChat.status}</p>
                                </div>
                            </div>

                            <div className="flex items-center gap-4 text-gray-600">
                                <i className="fas fa-phone cursor-pointer hover:text-blue-500"></i>
                                <i className="fas fa-video cursor-pointer hover:text-blue-500" onClick={() => setIsVideoCall(true)}></i>
                                
                                {/* 4 Dots Menu */}
                                <div className="relative">
                                    <button onClick={() => setShow4Dots(!show4Dots)} className="focus:outline-none font-bold text-lg tracking-widest">::::</button>
                                    {show4Dots && (
                                        <div className="absolute right-0 top-8 w-48 bg-white shadow-xl rounded z-50 py-1 text-sm animate-pulse-fast">
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer">Receiver Details</div>
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer">Mute Notifications</div>
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer">Mute Calls</div>
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer text-pink-600 font-bold" onClick={() => alert("Moving to Private Mode! Set Password.")}>Move to Private ❤️</div>
                                            <div className="border-t"></div>
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer text-red-500">Block User</div>
                                            <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer text-red-500">Remove Friend</div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Messages Area */}
                        <div className="flex-1 overflow-y-auto p-4 flex flex-col-reverse space-y-2 space-y-reverse">
                            {messages.map((msg) => (
                                <div key={msg.id} 
                                     className={`flex flex-col max-w-[70%] ${msg.sender === user.uid ? 'self-end items-end' : 'self-start items-start'}`}
                                     onDoubleClick={() => setReplyTo(msg)} // Simulate swipe to reply
                                >
                                    {/* Sender Name in Group/Public (Optional) */}
                                    {msg.sender !== user.uid && <span className="text-[10px] text-gray-500 ml-1 mb-1">{currentChat.name}</span>}

                                    <div className={`relative px-4 py-2 rounded-lg shadow-sm 
                                        ${msg.sender === user.uid 
                                            ? (isLoveTheme ? 'bg-pink-500 text-white rounded-br-none' : 'bg-blue-600 text-white rounded-br-none') 
                                            : (isLoveTheme ? 'bg-white text-pink-800 border border-pink-200 rounded-bl-none' : 'bg-white text-gray-800 rounded-bl-none')
                                        }`}
                                    >
                                        {/* Replied Message UI */}
                                        {msg.replyTo && (
                                            <div className={`mb-1 p-1 rounded text-xs border-l-2 ${msg.sender === user.uid ? 'bg-black/10 border-white' : 'bg-gray-100 border-blue-500'}`}>
                                                <span className="font-bold block">Replying to:</span>
                                                {msg.replyTo.text}
                                            </div>
                                        )}

                                        {/* Message Text */}
                                        <p>{msg.text} {msg.isEdited && <span className="text-[10px] opacity-60 ml-1">(edited)</span>}</p>
                                        
                                        {/* Timestamp & Ticks */}
                                        <div className="flex items-center justify-end gap-1 mt-1">
                                            <span className="text-[9px] opacity-70">
                                                {new Date(msg.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                            </span>
                                            {msg.sender === user.uid && (
                                                msg.seen ? <i className="fas fa-check-double text-[10px] text-blue-200"></i> : <i className="fas fa-check text-[10px] opacity-70"></i>
                                            )}
                                        </div>
                                    </div>

                                    {/* Message Actions (Edit/Delete) - Simulating Hold */}
                                    {msg.sender === user.uid && (
                                        <div className="flex gap-2 mt-1 text-[10px] text-gray-400 opacity-0 hover:opacity-100 transition-opacity">
                                            <button onClick={() => handleEdit(msg)} className="hover:text-blue-500">Edit</button>
                                            <button onClick={() => deleteMessage(msg.id, msg.timestamp)} className="hover:text-red-500">Delete</button>
                                            <button className="hover:text-gray-600">Unseen</button>
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>

                        {/* Input Area */}
                        <div className={`p-3 flex items-center gap-2 border-t ${isLoveTheme ? 'bg-pink-100' : 'bg-white'}`}>
                            {/* Private Mode: Seen -> Delete Toggle */}
                            {(isLoveTheme || isPrivateMode) && (
                                <div className="flex flex-col items-center cursor-pointer" onClick={() => setSeenAfterDelete(!seenAfterDelete)}>
                                    <div className={`w-8 h-4 rounded-full p-0.5 transition ${seenAfterDelete ? 'bg-pink-500' : 'bg-gray-300'}`}>
                                        <div className={`w-3 h-3 bg-white rounded-full shadow-sm transform transition ${seenAfterDelete ? 'translate-x-4' : 'translate-x-0'}`}></div>
                                    </div>
                                    <span className="text-[8px] text-gray-500">SeenDel</span>
                                </div>
                            )}

                            {/* Reply Indicator */}
                            {replyTo && (
                                <div className="absolute bottom-16 left-4 right-4 bg-gray-100 p-2 border-l-4 border-blue-500 rounded flex justify-between">
                                    <div>
                                        <p className="text-xs text-blue-500 font-bold">Replying to...</p>
                                        <p className="text-sm truncate">{replyTo.text}</p>
                                    </div>
                                    <button onClick={() => setReplyTo(null)} className="text-gray-500 px-2">X</button>
                                </div>
                            )}

                            <input 
                                type="text" 
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && sendMessage()}
                                placeholder={editingMsgId ? "Editing message..." : "Type a message..."}
                                className="flex-1 px-4 py-2 rounded-full border outline-none focus:ring-2 focus:ring-blue-300 bg-gray-50"
                            />
                            
                            {inputText ? (
                                <button onClick={sendMessage} className="w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center shadow hover:bg-blue-600">
                                    {editingMsgId ? <i className="fas fa-check"></i> : <i className="fas fa-paper-plane"></i>}
                                </button>
                            ) : (
                                <button className="w-10 h-10 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center">
                                    <i className="fas fa-microphone"></i>
                                </button>
                            )}
                        </div>
                    </div>
                );
            };

/* --- PART 4 END --- */
        /* --- PART 5 START --- */

            // Video Call Overlay (Full Screen)
            const VideoCallUI = () => (
                <div className="fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center text-white">
                    {/* Header */}
                    <div className="absolute top-8 left-8">
                        <h2 className="text-2xl font-bold">{currentChat?.name}</h2>
                        <p className="text-gray-400 animate-pulse">00:15</p>
                    </div>

                    {/* Main Video (Opposite User) */}
                    <div className="w-full h-full flex items-center justify-center bg-gray-800">
                         <div className="text-center">
                            <img src={currentChat?.avatar || "https://via.placeholder.com/150"} className="w-32 h-32 rounded-full mb-4 mx-auto animate-pulse border-4 border-green-500" />
                            <p>Star Video Call Connected...</p>
                         </div>
                    </div>

                    {/* Local Video (You) */}
                    <div className="absolute top-8 right-8 w-32 h-48 bg-gray-900 rounded-lg border border-gray-600 overflow-hidden shadow-2xl">
                        <div className="w-full h-full flex items-center justify-center text-xs text-gray-500">You</div>
                    </div>

                    {/* Controls */}
                    <div className="absolute bottom-10 flex items-center gap-6">
                        <button onClick={() => setIsMicDenied(!isMicDenied)} className={`p-4 rounded-full ${isMicDenied ? 'bg-white text-black' : 'bg-gray-700'}`}>
                            {isMicDenied ? <i className="fas fa-microphone-slash"></i> : <i className="fas fa-microphone"></i>}
                        </button>
                        <button onClick={() => setIsVideoCall(false)} className="p-5 bg-red-600 rounded-full text-white shadow-lg transform hover:scale-110 transition">
                            <i className="fas fa-phone-slash text-xl"></i>
                        </button>
                        <button className="p-4 rounded-full bg-gray-700 hover:bg-gray-600">
                            <i className="fas fa-video"></i>
                        </button>
                    </div>

                    {/* Permission Error Simulation */}
                    {isMicDenied && (
                        <div className="absolute top-1/2 bg-red-500 text-white px-4 py-2 rounded shadow">
                            Mic Denied! Please enable permissions.
                        </div>
                    )}
                </div>
            );

            // Password Modal for Privacy
            const PasswordModal = () => (
                <div className="fixed inset-0 bg-black/50 z-[60] flex items-center justify-center backdrop-blur-sm">
                    <div className="bg-white p-6 rounded-lg shadow-2xl w-80 text-center animate-bounce">
                        <div className="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i className="fas fa-lock text-pink-500 text-xl"></i>
                        </div>
                        <h2 className="text-xl font-bold mb-2">Private Access ❤️</h2>
                        <p className="text-xs text-gray-500 mb-4">Enter passcode to view hidden chats</p>
                        <input 
                            type="password" 
                            className="w-full text-center border-b-2 border-pink-300 outline-none text-2xl tracking-[10px] mb-4 pb-2"
                            value={passwordInput}
                            onChange={(e) => setPasswordInput(e.target.value)}
                            maxLength={4}
                            placeholder="...."
                        />
                        <div className="flex gap-2">
                            <button onClick={() => setShowPasswordModal(false)} className="flex-1 bg-gray-200 py-2 rounded text-sm font-bold">Cancel</button>
                            <button onClick={verifyPassword} className="flex-1 bg-pink-500 text-white py-2 rounded text-sm font-bold shadow-lg">Unlock</button>
                        </div>
                    </div>
                </div>
            );

            // --- MAIN RENDER ---
            
            // 1. Login Screen
            if (!user) {
                return (
                    <div className="h-screen w-screen flex flex-col items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800 text-white">
                        <h1 className="text-5xl font-serif mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-pink-600">True Chats</h1>
                        <p className="text-gray-400 mb-8">Secure. Private. Yours.</p>
                        <button onClick={handleLogin} className="bg-white text-gray-900 px-8 py-3 rounded-full font-bold shadow-lg hover:bg-gray-200 transition flex items-center gap-2">
                            <i className="fab fa-google"></i> Sign in with Google
                        </button>
                    </div>
                );
            }

            // 2. App Screen
            return (
                <div className={`h-screen w-screen flex flex-col overflow-hidden ${isLoveTheme ? 'love-theme-bg' : 'premium-theme-bg'}`}>
                    {isVideoCall && <VideoCallUI />}
                    {showPasswordModal && <PasswordModal />}
                    
                    <Header />
                    {showRequests && <RequestPopup />}
                    
                    <div className="flex flex-1 overflow-hidden">
                        <Sidebar />
                        <ChatWindow />
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
/* --- PART 5 END --- */
